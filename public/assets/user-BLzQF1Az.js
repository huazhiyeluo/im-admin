import{f as U,g as V,o as g,S as f,y as s,z as x,l as b,w as r,c as o,A as y,C as S,E as w,F as C}from"./index-CvA2DDGm.js";import{u as N,e as h}from"./index-Dti_npMt.js";import{_ as k}from"./_plugin-vue_export-helper-DlAUqK2U.js";const A={style:{margin:"16px"}},B=U({__name:"user",emits:["update-parameter"],setup(D,{emit:d}){const m=d,e=V({selftUserInfo:{},personInfo:{uid:0,username:"",avatar:"",info:""},fileList:[]});g(()=>{i()});const i=()=>{e.selftUserInfo=f.get("userInfo")},p=t=>{const a=new FormData;a.append("file",t.file),N(a).then(l=>{e.personInfo.avatar=l.data})},c=()=>{let t=JSON.parse(JSON.stringify(e.personInfo));t.uid=e.selftUserInfo.Uid,h(t).then(a=>{a.code==0?(w("保存成功"),e.selftUserInfo.Avatar=a.data.Avatar,e.selftUserInfo.Username=a.data.Username,e.selftUserInfo.Info=a.data.Info,f.set("userInfo",e.selftUserInfo),e.personInfo={uid:0,username:"",avatar:"",info:""},m("update-parameter")):C(a.msg)})};return(t,a)=>{const l=s("van-uploader"),u=s("van-field"),_=s("van-cell-group"),I=s("van-button"),v=s("van-form");return x(),b(v,{class:"person-user"},{default:r(()=>[o(_,{inset:""},{default:r(()=>[o(u,{name:"uploader",label:"头像"},{input:r(()=>[o(l,{accept:"image/*",modelValue:e.fileList,"onUpdate:modelValue":a[0]||(a[0]=n=>e.fileList=n),reupload:"","max-count":"1","after-read":p},null,8,["modelValue"])]),_:1}),o(u,{modelValue:e.personInfo.username,"onUpdate:modelValue":a[1]||(a[1]=n=>e.personInfo.username=n),name:"用户名",label:"用户名",placeholder:"用户名",rules:[{required:!0,message:"请填写用户名"}]},null,8,["modelValue"]),o(u,{modelValue:e.personInfo.info,"onUpdate:modelValue":a[2]||(a[2]=n=>e.personInfo.info=n),type:"textarea",name:"描述",label:"描述",placeholder:"描述",rules:[{required:!0,message:"请填写描述"}]},null,8,["modelValue"])]),_:1}),y("div",A,[o(I,{round:"",block:"",type:"primary",size:"small","native-type":"submit",onClick:c},{default:r(()=>[S(" 确认 ")]),_:1})])]),_:1})}}}),q=k(B,[["__scopeId","data-v-7485223c"]]);export{q as default};
