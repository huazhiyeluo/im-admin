import{f as U,g as b,o as x,S as F,y as m,z as t,j as o,G as M,H as B,p as a,l as D,c as _,A as e,B as r,w as I,C as u,E as S,F as z,L as A,M as O}from"./index-CvA2DDGm.js";import{o as j}from"./index-Dti_npMt.js";import{g as R,j as V,h as T}from"./chat-BrYYxUVl.js";import{_ as $}from"./_plugin-vue_export-helper-DlAUqK2U.js";const c=h=>(A("data-v-fc6037e6"),h=h(),O(),h),L={class:"msg-list"},E={key:0,class:"contact-item"},G={class:"user-details"},H={class:"user-name"},J={class:"status"},q=c(()=>e("span",null,"请求添加对方为好友",-1)),K={class:"user-operate"},P={key:0,class:"operate"},Q=c(()=>e("div",{class:"operate-right-30"},"等待验证",-1)),W=[Q],X={key:1,class:"operate"},Y=c(()=>e("div",{class:"operate-right"},"已被同意",-1)),Z=[Y],ss={key:2,class:"operate"},es=c(()=>e("div",{class:"operate-right"},"已被拒绝",-1)),ts=[es],os={key:1,class:"contact-item"},as={class:"user-details"},ns={class:"user-name"},cs={class:"status"},ds=c(()=>e("span",null,"对方请求添加你为好友",-1)),ls={class:"user-operate"},is={key:0,class:"operate"},rs={key:1,class:"operate"},_s=c(()=>e("div",{class:"operate-right"},"已同意",-1)),ps=[_s],hs={key:2,class:"operate"},us=c(()=>e("div",{class:"operate-right"},"已拒绝",-1)),vs=[us],ys={key:2,class:"contact-item"},fs={class:"user-details"},gs={class:"user-name"},Is={class:"status"},ks=c(()=>e("span",null,"请求加入群",-1)),ms={class:"user-operate"},Ss={key:0,class:"operate"},Ts=c(()=>e("div",{class:"operate-right-30"},"等待验证",-1)),Cs=[Ts],ws={key:1,class:"operate"},Ns=c(()=>e("div",{class:"operate-right"},"已被同意",-1)),Us=[Ns],bs={key:2,class:"operate"},xs=c(()=>e("div",{class:"operate-right"},"已被拒绝",-1)),Fs=[xs],Ms={key:3,class:"contact-item"},Bs={class:"user-details"},Ds={class:"user-name"},zs={class:"status"},As={style:{color:"red"}},Os={class:"user-operate"},js={key:0,class:"operate"},Rs={key:1,class:"operate"},Vs=c(()=>e("div",{class:"operate-right"},"已同意",-1)),$s=[Vs],Ls={key:2,class:"operate"},Es=c(()=>e("div",{class:"operate-right"},"已拒绝",-1)),Gs=[Es],Hs=U({__name:"msg",props:["db"],emits:["update-parameter"],setup(h,{expose:C,emit:Js}){const v=h,n=b({selftUserInfo:{},applys:[]});x(()=>{w()});const w=()=>{n.selftUserInfo=F.get("userInfo"),N()},N=async()=>{let p=Math.floor(Date.now()/1e3);const i=await R(v.db,"apply","OperateTime",p-24*3600*30,p);for(let d of i){const l=d;n.applys.push(l)}},y=async(p,i,d)=>{j({id:i,status:d}).then(f=>{f.code==0?(d==1?S("已同意"):d==2&&S("已拒绝"),n.applys[p].Status=d):z(f.msg)})};return C({loadUserManage:p=>{const i=JSON.parse(p.Content.Data);if(i.apply){if(n.applys.some(l=>l.Id===i.apply.Id)){for(const l in n.applys)if(n.applys[l].Id==i.apply.Id){n.applys[l]=i.apply;break}}else n.applys.unshift(i.apply);V(v.db,i.apply)}},clearMsg:()=>{n.applys=[],T(v.db,"apply",[{indexName:"Type",value:1}]),T(v.db,"apply",[{indexName:"Type",value:2}])}}),(p,i)=>{const d=m("van-image"),l=m("van-button"),f=m("van-empty");return t(),o("div",L,[n.applys.length>0?(t(!0),o(M,{key:0},B(n.applys,(s,g)=>(t(),o("div",null,[s.Type==1&&s.FromId==n.selftUserInfo.Uid?(t(),o("div",E,[_(d,{width:"50",height:"50",round:"",src:s.ToIcon},null,8,["src"]),e("div",G,[e("div",H,r(s.ToName),1),e("div",J,[q,e("span",null,"，附言："+r(s.Reason),1)])]),e("div",K,[s.Status==0?(t(),o("div",P,W)):a("",!0),s.Status==1?(t(),o("div",X,Z)):a("",!0),s.Status==2?(t(),o("div",ss,ts)):a("",!0)])])):a("",!0),s.Type==1&&s.ToId==n.selftUserInfo.Uid?(t(),o("div",os,[_(d,{width:"50",height:"50",round:"",src:s.FromIcon},null,8,["src"]),e("div",as,[e("div",ns,r(s.FromName),1),e("div",cs,[ds,e("span",null,"，附言："+r(s.Reason),1)])]),e("div",ls,[s.Status==0?(t(),o("div",is,[_(l,{type:"success",size:"small",onClick:k=>y(g,s.Id,1)},{default:I(()=>[u("同意")]),_:2},1032,["onClick"]),_(l,{size:"small",onClick:k=>y(g,s.Id,2)},{default:I(()=>[u("拒绝")]),_:2},1032,["onClick"])])):a("",!0),s.Status==1?(t(),o("div",rs,ps)):a("",!0),s.Status==2?(t(),o("div",hs,vs)):a("",!0)])])):a("",!0),s.Type==2&&s.FromId==n.selftUserInfo.Uid?(t(),o("div",ys,[_(d,{width:"50",height:"50",round:"",src:s.ToIcon},null,8,["src"]),e("div",fs,[e("div",gs,r(s.ToName),1),e("div",Is,[ks,e("span",null,"，附言："+r(s.Reason),1)])]),e("div",ms,[s.Status==0?(t(),o("div",Ss,Cs)):a("",!0),s.Status==1?(t(),o("div",ws,Us)):a("",!0),s.Status==2?(t(),o("div",bs,Fs)):a("",!0)])])):a("",!0),s.Type==2&&s.FromId!=n.selftUserInfo.Uid?(t(),o("div",Ms,[_(d,{width:"50",height:"50",round:"",src:s.ToIcon},null,8,["src"]),e("div",Bs,[e("div",Ds,r(s.ToName),1),e("div",zs,[e("span",null,[e("span",As,r(s.FromName),1),u("请求加入群")]),e("span",null,"，附言："+r(s.Reason),1)])]),e("div",Os,[s.Status==0?(t(),o("div",js,[_(l,{type:"success",size:"small",onClick:k=>y(g,s.Id,1)},{default:I(()=>[u("同意")]),_:2},1032,["onClick"]),_(l,{size:"small",onClick:k=>y(g,s.Id,2)},{default:I(()=>[u("拒绝")]),_:2},1032,["onClick"])])):a("",!0),s.Status==1?(t(),o("div",Rs,$s)):a("",!0),s.Status==2?(t(),o("div",Ls,Gs)):a("",!0)])])):a("",!0)]))),256)):a("",!0),n.applys.length==0?(t(),D(f,{key:1,description:"暂无消息"})):a("",!0)])}}}),Ys=$(Hs,[["__scopeId","data-v-fc6037e6"]]);export{Ys as default};
