import{f as z,g as I,j as L,c as s,l as k,w as d,p as x,G as R,y as c,x as q,z as v,A as m,C as g,S as w,E as h,F as f}from"./index-CvA2DDGm.js";import{l as D,r as B}from"./index-Dti_npMt.js";import{_ as N}from"./_plugin-vue_export-helper-DlAUqK2U.js";let y;const T=new Uint8Array(16);function E(){if(!y&&(y=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!y))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return y(T)}const n=[];for(let e=0;e<256;++e)n.push((e+256).toString(16).slice(1));function j(e,o=0){return n[e[o+0]]+n[e[o+1]]+n[e[o+2]]+n[e[o+3]]+"-"+n[e[o+4]]+n[e[o+5]]+"-"+n[e[o+6]]+n[e[o+7]]+"-"+n[e[o+8]]+n[e[o+9]]+"-"+n[e[o+10]]+n[e[o+11]]+n[e[o+12]]+n[e[o+13]]+n[e[o+14]]+n[e[o+15]]}const A=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),C={randomUUID:A};function G(e,o,t){if(C.randomUUID&&!o&&!e)return C.randomUUID();e=e||{};const r=e.random||(e.rng||E)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,o){t=t||0;for(let u=0;u<16;++u)o[t+u]=r[u];return o}return j(r)}const H={style:{margin:"16px"}},K={style:{margin:"16px"}},$=z({__name:"login",setup(e){const o=q(),t=I({isShowLogin:!0,title:"登录",loginForm:{username:"",password:""},registerForm:{username:"",password:"",repassword:""}}),r=()=>{D(t.loginForm).then(i=>{i.code==0?(w.set("userInfo",i.data),w.set("token",i.token),w.set("sessionKey",G()),h("登录成功"),o.push("/")):f(i.msg)})},u=()=>{B(t.registerForm).then(i=>{i.code==0?(h("注册成功"),V()):f(i.msg)})},_=()=>{t.isShowLogin=!1,t.title="注册"},V=()=>{t.isShowLogin=!0,t.title="登录"};return(i,l)=>{const S=c("van-nav-bar"),p=c("van-field"),F=c("van-cell-group"),b=c("van-button"),U=c("van-form");return v(),L(R,null,[s(S,{title:t.title},null,8,["title"]),t.isShowLogin?(v(),k(U,{key:0,class:"im-form"},{default:d(()=>[s(F,{inset:""},{default:d(()=>[s(p,{modelValue:t.loginForm.username,"onUpdate:modelValue":l[0]||(l[0]=a=>t.loginForm.username=a),name:"用户名",label:"",placeholder:"用户名",rules:[{required:!0,message:"请填写用户名"}]},null,8,["modelValue"]),s(p,{modelValue:t.loginForm.password,"onUpdate:modelValue":l[1]||(l[1]=a=>t.loginForm.password=a),type:"password",name:"密码",autocomplete:"off",label:"",placeholder:"密码",rules:[{required:!0,message:"请填写密码"}]},null,8,["modelValue"])]),_:1}),m("div",H,[s(b,{round:"",block:"",type:"danger",size:"small","native-type":"submit",onClick:r},{default:d(()=>[g(" 登录 ")]),_:1}),m("div",{class:"to-button"},[m("span",{type:"primary",size:"small",plain:"",onClick:_},"注册账号"),g(" | "),m("span",{type:"primary",size:"small",plain:"",onClick:_},"忘记密码")])])]),_:1})):x("",!0),t.isShowLogin?x("",!0):(v(),k(U,{key:1,class:"im-form"},{default:d(()=>[s(F,{inset:""},{default:d(()=>[s(p,{modelValue:t.registerForm.username,"onUpdate:modelValue":l[2]||(l[2]=a=>t.registerForm.username=a),name:"用户名",label:"",placeholder:"用户名",rules:[{required:!0,message:"请填写用户名"}]},null,8,["modelValue"]),s(p,{modelValue:t.registerForm.password,"onUpdate:modelValue":l[3]||(l[3]=a=>t.registerForm.password=a),type:"password",name:"密码",autocomplete:"off",label:"",placeholder:"密码",rules:[{required:!0,message:"请填写密码"}]},null,8,["modelValue"]),s(p,{modelValue:t.registerForm.repassword,"onUpdate:modelValue":l[4]||(l[4]=a=>t.registerForm.repassword=a),type:"password",name:"确认密码",autocomplete:"off",label:"",placeholder:"确认密码",rules:[{required:!0,message:"请填写确认密码"}]},null,8,["modelValue"])]),_:1}),m("div",K,[s(b,{round:"",block:"",type:"danger",size:"small","native-type":"submit",onClick:u},{default:d(()=>[g(" 注册 ")]),_:1}),m("div",{class:"to-button"},[m("span",{type:"primary",size:"small",plain:"",onClick:V},"登录账号"),g(" | "),m("span",{type:"primary",size:"small",plain:"",onClick:_},"忘记密码")])])]),_:1}))],64)}}}),P=N($,[["__scopeId","data-v-f9aa87e0"]]);export{P as default};
